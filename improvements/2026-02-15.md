# Improvement Log — 2026-02-15

## Comprehensive Optimization: SW + HW + Accelerator

**Original Baseline:** 48,886,157 cycles  
**End of Day Result:** 6,698,993 cycles (**−86.3%**, 7.30× speedup)

Workload: 100 MNIST images through a 2-layer INT8 MLP (784→128→10).

---

### Strategy A: Software Optimizations
> 48,886,157 → 44,830,519 cycles (**−8.3%**)

| ID | Optimization | Description |
|----|---|---|
| A1 | Reciprocal multiply | Replaced divisions with multiply-shifts |
| A2 | 8× loop unrolling | Doubled matmul inner loop unrolling |
| A3 | Fused kernels | Combined add_bias + relu + rescale |
| A4 | `-O3` compiler flag | Aggressive inlining |

### Strategy B: Pipeline & Branch Prediction (RTL)
> 44,830,519 → 44,830,278 cycles (**−241 cycles**)

| ID | Optimization | Description |
|----|---|---|
| B1 | Fix jump bubble | JAL/JALR use BTB prediction |
| B2 | Larger BHT/BTB | Doubled predictor tables |

### Strategy D: Decoupled Matmul Accelerator (V1)
> 44,830,278 → 6,698,993 cycles (**−85.1%**, 6.69× speedup)

First implementation of the 4-lane INT8 accelerator sharing the CPU's 32-bit dcache port.

#### Accelerator Architecture
*   MMIO @ 0x80000000.
*   Takes over dcache port via MUX.
*   4-lane packed INT8 MAC array.
*   Loads weights/inputs via CPU's 32-bit bus (bottleneck).

#### Cumulative Results (2026-02-15)
| Stage | Cycles | Speedup |
|-------|--------|---------|
| Original baseline | 48,886,157 | 1.00× |
| + Strategy A | 44,830,519 | 1.09× |
| + Strategy B | 44,830,278 | 1.09× |
| + Strategy D | **6,698,993** | **7.30×** |
